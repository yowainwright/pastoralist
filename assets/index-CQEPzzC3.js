import{a as e,r}from"./router-BvpRj3gN.js";import"./react-vendor-Cgg2GOmP.js";const j=({stepNumber:s,title:t,description:n,visible:l,showEmoji:i,verticalCenter:c})=>{if(!l)return null;const x=c?"top-1/2 -translate-y-1/2":"top-12";return e.jsx("div",{className:`absolute z-10 w-64 right-4 ${x} animate-pop-in`,children:e.jsxs("div",{className:"bg-base-100/95 backdrop-blur-sm border-2 border-blue-600 rounded-lg shadow-xl shadow-blue-500/15 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gradient-to-b from-blue-400 to-blue-500 border-2 border-blue-600 text-white text-sm font-bold shadow-md shadow-blue-500/25",children:s}),e.jsx("span",{className:"font-bold text-base-content",children:t})]}),e.jsxs("div",{className:"text-sm text-base-content/70 ml-8",children:[n,i&&e.jsx("span",{className:"inline-block ml-1 animate-bounce-once",children:"âš¡"})]})]})})},v=({isActive:s=!1,minHeight:t,children:n})=>{const l=s?"ring-2 ring-primary ring-offset-2":"",i=t?{minHeight:t}:void 0;return e.jsx("div",{className:`terminal-window transition-all duration-300 ${l}`,style:i,children:n})},N=({fileName:s})=>{const t=s??"terminal";return e.jsxs("div",{className:"terminal-header",children:[e.jsx("div",{className:"terminal-dot terminal-dot-red"}),e.jsx("div",{className:"terminal-dot terminal-dot-yellow"}),e.jsx("div",{className:"terminal-dot terminal-dot-green"}),e.jsx("span",{className:"ml-3 text-slate-400 text-xs",children:t})]})},U=({isActive:s})=>e.jsxs(v,{isActive:s,children:[e.jsx(N,{fileName:"package.json"}),e.jsxs("div",{className:"terminal-content text-sm",style:{height:"auto"},children:[e.jsx("div",{className:"terminal-line text-base-content/50",children:"{"}),e.jsxs("div",{className:"terminal-line",children:["  ",e.jsx("span",{className:"text-primary",children:'"overrides"'}),": ","{"]}),e.jsxs("div",{className:"terminal-line",children:["    ",e.jsx("span",{className:"text-primary",children:'"lodash"'}),":"," ",e.jsx("span",{className:"text-success",children:'"4.17.21"'})]}),e.jsx("div",{className:"terminal-line",children:"  }"}),e.jsx("div",{className:"terminal-line text-base-content/50",children:"}"})]})]}),G=({isActive:s,typedCommand:t,phase:n,showSpinner:l,showSuccess:i})=>{const c=n==="step2";return e.jsxs(v,{isActive:s,children:[e.jsx(N,{}),e.jsxs("div",{className:"terminal-content text-sm",style:{height:"auto",padding:"0.75rem 1rem"},children:[e.jsxs("div",{className:"terminal-line",children:[e.jsx("span",{className:"terminal-prefix",children:"$"}),e.jsx("span",{children:t}),c&&e.jsx("span",{className:"cursor"})]}),l&&e.jsxs("div",{className:"terminal-line text-cyan-400",children:[e.jsx("span",{className:"inline-block animate-spin mr-2",children:"â ‹"}),"checking herd..."]}),i&&e.jsx("div",{className:"terminal-line text-success",children:"ðŸ‘©ðŸ½â€ðŸŒ¾ the herd is safe!"})]})]})},m=[{title:"The Problem",description:"Overrides exist but nobody knows why. Which packages depend on it?"},{title:"Run Pastoralist",description:"Pastoralist scans your dependencies and documents your overrides."},{title:"Automatic Documentation",description:"Now you know why each override exists, what depends on it, and any associated CVEs."}],K=["Undocumented overrides","Execute pastoralist","Pastoralist manages the rest"],R=['  "pastoralist": {','    "appendix": {','      "lodash@4.17.21": {','        "dependents": {','          "express": "^4.18.0"',"        },",'        "ledger": {','          "reason": "security",','          "cve": "CVE-2020-8203"',"        }","      }","    }","  }"],f="pastoralist",W=/"([^"]+)":/g,Y=/: "([^"]+)"/g,z=['"pastoralist"','"appendix"','"lodash@','"dependents"','"express"','"ledger"','"reason"','"cve"'],X=s=>z.some(t=>s.includes(t)),q=s=>s.replace(W,'<span class="text-primary">"$1"</span>:').replace(Y,': <span class="text-success">"$1"</span>'),F=({line:s,isAdded:t=!1})=>{const n=t?"terminal-line json-added":"terminal-line";if(!X(s))return e.jsx("div",{className:n,children:s});const i=q(s);return e.jsx("div",{className:n,dangerouslySetInnerHTML:{__html:i}})},Q=({isActive:s,appendixLines:t})=>{const n=R.slice(0,t),l=t>0;return e.jsxs(v,{isActive:s,minHeight:"420px",children:[e.jsx(N,{fileName:"package.json"}),e.jsxs("div",{className:"terminal-content text-sm",style:{height:"auto"},children:[e.jsx("div",{className:"terminal-line text-base-content/50",children:"{"}),e.jsxs("div",{className:"terminal-line",children:["  ",e.jsx("span",{className:"text-primary",children:'"overrides"'}),": ","{"]}),e.jsxs("div",{className:"terminal-line",children:["    ",e.jsx("span",{className:"text-primary",children:'"lodash"'}),":"," ",e.jsx("span",{className:"text-success",children:'"4.17.21"'})]}),e.jsxs("div",{className:"terminal-line",children:["  }",l&&","]}),n.map((i,c)=>e.jsx(F,{line:i,isAdded:!0},c)),e.jsx("div",{className:"terminal-line text-base-content/50",children:"}"})]})]})},se=({onComplete:s})=>{const[t,n]=r.useState("idle"),[l,i]=r.useState(""),[c,x]=r.useState(!1),[_,b]=r.useState(!1),[H,w]=r.useState(0),[h,p]=r.useState(0),[O,S]=r.useState(!1),y=r.useRef(null),T=r.useRef(!1),u=r.useRef(null);r.useEffect(()=>{const a=new IntersectionObserver(d=>{d[0]?.isIntersecting&&!T.current&&(T.current=!0,C())},{threshold:.3}),o=y.current;return o&&a.observe(o),()=>{o&&a.unobserve(o)}},[]);const g=()=>{u.current&&(clearInterval(u.current),u.current=null)},A=()=>{g(),i(""),x(!1),b(!1),w(0),S(!1)},C=()=>{A(),n("step1"),p(1),setTimeout(()=>{E()},2e3)},E=()=>{n("step2"),p(2);let a=0;u.current=setInterval(()=>{a<f.length?(i(f.slice(0,a+1)),a++):(g(),setTimeout(()=>{n("checking"),x(!0),setTimeout(()=>{x(!1),b(!0),setTimeout(()=>{n("step3"),p(3),P()},600)},1e3)},200))},30)},P=()=>{let a=0;u.current=setInterval(()=>{a<R.length?(w(a+1),a++):(g(),n("complete"),setTimeout(()=>{S(!0),s?.()},300))},120)},$=a=>{A(),a===1?C():a===2?(n("step2"),p(2),E()):a===3&&(i(f),b(!0),n("step3"),p(3),P())},I=h===1,k=h===2,L=h===3;return e.jsxs("div",{ref:y,className:"flex flex-col gap-12",children:[e.jsx("ul",{className:"steps w-full",children:K.map((a,o)=>{const d=o+1,D=h>d||d===3&&t==="complete",J=h>=d,V="step cursor-pointer transition-all duration-200 text-base-content",B=J?"step-primary [&::before]:!bg-gradient-to-b [&::before]:!from-blue-400 [&::before]:!to-blue-500 [&::before]:!border-2 [&::before]:!border-blue-600 [&::before]:shadow-md [&::before]:shadow-blue-500/25 [&::before]:!text-white [&::after]:!bg-blue-500":"[&::before]:border-2 [&::before]:border-base-content/20 [&::before]:text-base-content",M=D?"âœ“":d;return e.jsx("li",{className:`${V} ${B}`,onClick:()=>$(d),"data-content":M,children:a},o)})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 lg:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(j,{stepNumber:1,title:m[0].title,description:m[0].description,visible:I}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-base-content/60 text-sm",children:"Undocumented overrides"}),e.jsx("span",{className:"badge badge-lg text-white bg-gradient-to-b from-red-400 to-red-500 border-2 border-red-600 shadow-md shadow-red-500/25",children:"Before"})]}),e.jsx(U,{isActive:I})]}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{stepNumber:2,title:m[1].title,description:m[1].description,visible:k}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-base-content/60 text-sm",children:"Execute the pastoralist cli"}),e.jsx("span",{className:"badge badge-lg text-white bg-gradient-to-b from-blue-400 to-blue-500 border-2 border-blue-600 shadow-md shadow-blue-500/25",children:"CLI"})]}),e.jsx(G,{isActive:k,typedCommand:l,phase:t,showSpinner:c,showSuccess:_})]})]}),e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(j,{stepNumber:3,title:m[2].title,description:m[2].description,visible:L,showEmoji:O,verticalCenter:!0}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-base-content/60 text-sm",children:"Documented overrides"}),e.jsx("span",{className:"badge badge-lg text-white bg-gradient-to-b from-green-400 to-green-500 border-2 border-green-600 shadow-md shadow-green-500/25",children:"After"})]}),e.jsx(Q,{isActive:L,appendixLines:H})]})]})]})};export{se as TransformDemo};
