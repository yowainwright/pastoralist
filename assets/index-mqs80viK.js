import{a as e,r as n}from"./router-BhS44BMw.js";import{u as q}from"./HomePage-qTwjgnnB.js";import"./react-vendor-C6WxKkic.js";import"./mermaid-CnIU0GOH.js";import"./constants-C2jIzel-.js";import"./index-Cc33n_ba.js";const A=({stepNumber:t,title:s,description:r,visible:i,showEmoji:c,verticalCenter:l})=>{if(!i)return null;const o=l?"top-1/2 -translate-y-1/2":"top-12";return e.jsx("div",{className:`absolute z-10 w-64 right-4 ${o} animate-pop-in`,children:e.jsxs("div",{className:"bg-base-100/95 backdrop-blur-sm border-2 border-blue-600 rounded-lg shadow-xl shadow-blue-500/15 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gradient-to-b from-blue-400 to-blue-500 border-2 border-blue-600 text-white text-sm font-bold shadow-md shadow-blue-500/25",children:t}),e.jsx("span",{className:"font-bold text-base-content",children:s})]}),e.jsxs("div",{className:"text-sm text-base-content/70 ml-8",children:[r,c&&e.jsx("span",{className:"inline-block ml-1 animate-bounce-once",children:"âš¡"})]})]})})},y=({isActive:t=!1,minHeight:s,children:r})=>{const i=t?"ring-2 ring-primary ring-offset-2":"",c=s?{minHeight:s}:void 0;return e.jsx("div",{className:`terminal-window transition-all duration-300 ${i}`,style:c,children:r})},C=({fileName:t})=>{const s=t??"terminal";return e.jsxs("div",{className:"terminal-header",children:[e.jsx("div",{className:"terminal-dot terminal-dot-red"}),e.jsx("div",{className:"terminal-dot terminal-dot-yellow"}),e.jsx("div",{className:"terminal-dot terminal-dot-green"}),e.jsx("span",{className:"ml-3 text-slate-400 text-xs",children:s})]})},Q=({isActive:t})=>e.jsxs(y,{isActive:t,children:[e.jsx(C,{fileName:"package.json"}),e.jsxs("div",{className:"terminal-content text-sm",style:{height:"auto"},children:[e.jsx("div",{className:"terminal-line text-base-content/50",children:"{"}),e.jsxs("div",{className:"terminal-line",children:["  ",e.jsx("span",{className:"text-primary",children:'"overrides"'}),": ","{"]}),e.jsxs("div",{className:"terminal-line",children:["    ",e.jsx("span",{className:"text-primary",children:'"lodash"'}),":"," ",e.jsx("span",{className:"text-success",children:'"4.17.21"'})]}),e.jsx("div",{className:"terminal-line",children:"  }"}),e.jsx("div",{className:"terminal-line text-base-content/50",children:"}"})]})]}),Z=({isActive:t,typedCommand:s,phase:r,showSpinner:i,showSuccess:c})=>{const l=r==="step2";return e.jsxs(y,{isActive:t,children:[e.jsx(C,{}),e.jsxs("div",{className:"terminal-content text-sm",style:{height:"auto",padding:"0.75rem 1rem"},children:[e.jsxs("div",{className:"terminal-line",children:[e.jsx("span",{className:"terminal-prefix",children:"$"}),e.jsx("span",{children:s}),l&&e.jsx("span",{className:"cursor"})]}),i&&e.jsxs("div",{className:"terminal-line text-cyan-400",children:[e.jsx("span",{className:"inline-block animate-spin mr-2",children:"â ‹"}),"checking herd..."]}),c&&e.jsx("div",{className:"terminal-line text-success",children:"ðŸ‘©ðŸ½â€ðŸŒ¾ the herd is safe!"})]})]})},b=[{title:"The Problem",description:"Overrides exist but nobody knows why. Which packages depend on it?"},{title:"Run Pastoralist",description:"Pastoralist scans your dependencies and documents your overrides."},{title:"Automatic Documentation",description:"Now you know why each override exists, what depends on it, and any associated CVEs."}],ee=["Undocumented overrides","Execute pastoralist","Pastoralist manages the rest"],f=['  "pastoralist": {','    "appendix": {','      "lodash@4.17.21": {','        "dependents": {','          "express": "^4.18.0"',"        },",'        "ledger": {','          "reason": "security",','          "cve": "CVE-2020-8203"',"        }","      }","    }","  }"],N="pastoralist",se=/"([^"]+)":/g,te=/: "([^"]+)"/g,ne=['"pastoralist"','"appendix"','"lodash@','"dependents"','"express"','"ledger"','"reason"','"cve"'],ae=t=>ne.some(s=>t.includes(s)),ie=t=>t.replace(se,'<span class="text-primary">"$1"</span>:').replace(te,': <span class="text-success">"$1"</span>'),G=({line:t,isAdded:s=!1,className:r})=>{const i=s?"terminal-line json-added":"terminal-line",c=r?`${i} ${r}`:i;if(!ae(t))return e.jsx("div",{className:c,children:t});const o=ie(t);return e.jsx("div",{className:c,dangerouslySetInnerHTML:{__html:o}})},V=5,B=24,le=44,re=32,ce=le+re+(V+f.length)*B,oe=({isActive:t,appendixLines:s})=>{const r=f.slice(0,s),i=f.slice(s),c=s>0;return e.jsxs(y,{isActive:t,minHeight:`${ce}px`,children:[e.jsx(C,{fileName:"package.json"}),e.jsxs("div",{className:"terminal-content text-sm",style:{minHeight:`${(V+f.length)*B}px`},children:[e.jsx("div",{className:"terminal-line text-base-content/50",children:"{"}),e.jsxs("div",{className:"terminal-line",children:["  ",e.jsx("span",{className:"text-primary",children:'"overrides"'}),": ","{"]}),e.jsxs("div",{className:"terminal-line",children:["    ",e.jsx("span",{className:"text-primary",children:'"lodash"'}),":"," ",e.jsx("span",{className:"text-success",children:'"4.17.21"'})]}),e.jsxs("div",{className:"terminal-line",children:["  }",c&&","]}),r.map((l,o)=>e.jsx(G,{line:l,isAdded:!0},o)),i.map((l,o)=>e.jsx(G,{line:l,isAdded:!0,className:"invisible"},`hidden-${o}`)),e.jsx("div",{className:"terminal-line text-base-content/50",children:"}"})]})]})};function be(){const[t,s]=n.useState("idle"),[r,i]=n.useState(""),[c,l]=n.useState(!1),[o,S]=n.useState(!1),[E,P]=n.useState(0),[h,g]=n.useState(0),[J,I]=n.useState(!1),[p,k]=n.useState(!1),[T,L]=n.useState(!1),H=n.useRef(!1),u=n.useRef(null),w=n.useRef(null),d=n.useCallback(()=>{u.current&&(clearInterval(u.current),u.current=null)},[]),j=n.useCallback(a=>{let m=a;u.current=setInterval(()=>{m<f.length?(P(m+1),m++):(d(),s("complete"),L(!0),setTimeout(()=>{I(!0)},150))},60)},[d]),_=n.useCallback(()=>{s("step2"),g(2);let a=0;u.current=setInterval(()=>{a<N.length?(i(N.slice(0,a+1)),a++):(d(),setTimeout(()=>{s("checking"),l(!0),setTimeout(()=>{l(!1),S(!0),setTimeout(()=>{s("step3"),g(3),j(0)},300)},500)},100))},20)},[d,j]),$=n.useCallback(()=>{d(),i(""),l(!1),S(!1),P(0),I(!1)},[d]),X=n.useCallback(()=>{$(),s("step1"),g(1),setTimeout(()=>{_()},800)},[$,_]),M=n.useCallback(()=>{if(!p||!w.current)return;k(!1);const{phase:a,typedCommand:m,appendixLines:x}=w.current;if(w.current=null,a==="step2"&&m.length<N.length){let v=m.length;u.current=setInterval(()=>{v<N.length?(i(N.slice(0,v+1)),v++):(d(),setTimeout(()=>{s("checking"),l(!0),setTimeout(()=>{l(!1),S(!0),setTimeout(()=>{s("step3"),g(3),j(0)},300)},500)},100))},20)}else a==="step3"&&x<f.length&&j(x)},[p,d,j]),{ref:U}=q({threshold:.3,onChange:a=>{a&&(H.current?p&&M():(H.current=!0,X()))}}),K=a=>{d(),w.current={phase:t,typedCommand:r,appendixLines:E},k(!0),L(!1),g(a),a===1?s("step1"):a===2?s("step2"):a===3&&s("step3")},R=p?h===1:h>=1||T,D=p?h===2:h>=2||T,O=p?h===3:h>=3||T;return e.jsxs("div",{ref:U,className:"flex flex-col gap-12",children:[e.jsx("ul",{className:"steps w-full",children:ee.map((a,m)=>{const x=m+1,v=h>x||x===3&&t==="complete",W=h>=x,Y="step cursor-pointer transition-all duration-200 text-base-content",z=W?"step-primary [&::before]:!bg-gradient-to-b [&::before]:!from-blue-400 [&::before]:!to-blue-500 [&::before]:!border-2 [&::before]:!border-blue-600 [&::before]:shadow-md [&::before]:shadow-blue-500/25 [&::before]:!text-white [&::after]:!bg-blue-500":"[&::before]:border-2 [&::before]:border-base-content/20 [&::before]:text-base-content",F=v?"âœ“":x;return e.jsx("li",{className:`${Y} ${z}`,onClick:()=>K(x),"data-content":F,children:a},m)})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 lg:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(A,{stepNumber:1,title:b[0].title,description:b[0].description,visible:R}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-base-content/60 text-sm",children:"Undocumented overrides"}),e.jsx("span",{className:"badge badge-lg text-white bg-gradient-to-b from-red-400 to-red-500 border-2 border-red-600 shadow-md shadow-red-500/25",children:"Before"})]}),e.jsx(Q,{isActive:R})]}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{stepNumber:2,title:b[1].title,description:b[1].description,visible:D}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-base-content/60 text-sm",children:"Execute the pastoralist cli"}),e.jsx("span",{className:"badge badge-lg text-white bg-gradient-to-b from-blue-400 to-blue-500 border-2 border-blue-600 shadow-md shadow-blue-500/25",children:"CLI"})]}),e.jsx(Z,{isActive:D,typedCommand:r,phase:t,showSpinner:c,showSuccess:o})]})]}),e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(A,{stepNumber:3,title:b[2].title,description:b[2].description,visible:O,showEmoji:J,verticalCenter:!0}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-base-content/60 text-sm",children:"Documented overrides"}),e.jsx("span",{className:"badge badge-lg text-white bg-gradient-to-b from-green-400 to-green-500 border-2 border-green-600 shadow-md shadow-green-500/25",children:"After"})]}),e.jsx(oe,{isActive:O,appendixLines:E})]})]})]})}export{be as TransformDemo};
